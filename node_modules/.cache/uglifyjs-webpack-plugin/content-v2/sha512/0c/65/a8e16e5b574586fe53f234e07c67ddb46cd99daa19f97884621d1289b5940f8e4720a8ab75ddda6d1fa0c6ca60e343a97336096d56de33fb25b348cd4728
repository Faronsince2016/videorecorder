{"code":"!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t){var n,o,i,r=document.getElementById(\"openCamera\"),c=document.getElementById(\"closeCamera\"),a=document.getElementById(\"cutPic\"),d=document.getElementById(\"clearPic\"),l=document.getElementById(\"videoCapture\"),u=document.getElementById(\"pause\"),f=document.getElementById(\"start\"),m=document.getElementById(\"stop\"),s=document.getElementById(\"imgWrap\"),g=(document.getElementById(\"vedio\"),document.getElementById(\"videoWrap\")),h=document.getElementById(\"clearVideo\"),v=document.getElementById(\"batchDownloadPics\"),p=document.getElementById(\"batchDownloadVideos\"),w={audio:!0,video:{width:480,height:320}},y=function(){var e=document.createElement(\"canvas\");return e.width=w.video.width/2,e.height=w.video.height/2,e}(),E=y.getContext(\"2d\"),k=\"\",I=[],U=[],b=0;function M(e){window.URL||window.webkitURL;n=e,video.width=w.video.width+40,video.height=w.video.height+20,video.srcObject=e,video.play()}function T(e){console.log(\"访问用户媒体设备失败：\",e.name,e.message)}function B(){if(i)return alert(\"当前有视频正在录制，不能重新开始！\"),!1;C(),n?((o=new MediaRecorder(n)).ondataavailable=function(e){k=e.data,function(){let e=document.createElement(\"video\");e.width=video.width/3,e.height=video.height/3,e.controls=!0,U.push(k);let t=window.URL.createObjectURL(k);k=\"\",o=null,e.src=t,g.firstChild.nodeType===document.TEXT_NODE?g.replaceChild(e,g.firstChild):g.appendChild(e);let n=document.createElement(\"a\"),i=randomWord()+\".flv\";n.download=i,n.href=t,e.onclick=function(){n.click()}}()},o.start(),L()):alert(\"未检测到摄像头，请先打开摄像头！\")}function C(){i&&(b=0,l.innerHTML=\"视频录制\",clearInterval(i),i=null)}function L(){i&&clearInterval(i),i=setInterval(function(){b+=1,l.innerHTML=\"视频录制（已录制\"+b+\"s)\"},1e3)}function O(e,t,n){var o=\"png\"===e?\"screen_shots.zip\":\"vedio_collect.zip\",i=new JSZip;t.forEach(t=>{let o=randomWord()+\".\"+e;i.file(o,t,n)}),i.generateAsync({type:\"blob\"}).then(function(e){saveAs(e,o)})}r.onclick=function(){navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia?function(e,t,n){navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(e).then(t).catch(n):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(e).then(t).catch(n):navigator.mozGetUserMedia?navagator.mozGetUserMedia(e).then(t).catch(n):navigator.getUserMedia&&navigator.getUserMedia(e).then(t).catch(n)}(w,M,T):alert(\"你的浏览器不支持访问用户媒体设备\")},c.onclick=function(){n?(n.getTracks().forEach(e=>{e.stop()}),n=null,video.src=\"\",video.load()):alert(\"未检测到摄像头！\")},a.onclick=function(){if(!n)return alert(\"未检测到视频资源！请先打开摄像头\"),!1;E.drawImage(video,0,0,y.width,y.height);let e=y.toDataURL(\"image/png\"),t=function(e,t){let n=e.split(\",\"),o=n[0].match(/:(.*?);/)[1]||t,i=window.atob(n[1]),r=new ArrayBuffer(i.length),c=new Uint8Array(r);for(let e=0;e<i.length;e++)c[e]=i.charCodeAt(e);return new Blob([r],{type:o})}(e);I.push(t);let o=document.createElement(\"a\");o.download=randomWord()+\".png\",o.href=window.URL.createObjectURL(t);let i=new Image;i.onload=function(){s.firstChild.nodeType===document.TEXT_NODE?s.replaceChild(i,s.firstChild):s.appendChild(i),i.onload=null},i.onclick=function(){o.click()},i.src=e},d.onclick=function(){if(s.firstChild.nodeType===document.TEXT_NODE)return alert(\"当前还没有截图哦~\"),!1;window.confirm(\"确定要清空所有截图吗？\")&&(s.innerHTML=\"暂无截图\",I=[])},l.onclick=function(){B()},u.onclick=function(){return o?\"recording\"!==o.state?(alert(\"当前不是录制状态，无法执行暂停操作！！\"),!1):(clearInterval(i),void(o&&o.pause())):(alert(\"操作无效，未检测到摄像头！\"),!1)},f.onclick=function(){o?(L(),o&&o.resume()):B()},m.onclick=function(){if(!o)return alert(\"操作无效，未检测到摄像头！\"),!1;o&&o.stop(),C(),o=null},h.onclick=function(){if(g.firstChild.nodeType===document.TEXT_NODE)return alert(\"当前还没有视频哦~\"),!1;window.confirm(\"确定要清空所有视频吗？\")&&(U=[],g.innerHTML=\"暂无视频\")},v.onclick=function(){if(!I.length)return alert(\"还没有添加任何截图！！！\"),!1;O(\"png\",I)},p.onclick=function(){if(!U.length)return alert(\"还没有添加任何视频！！！\"),!1;O(\"flv\",U)}}]);","extractedComments":[]}